<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Multi‑District Electoral Calculator</title>
    <!-- TailwindCSS CDN (ok для тестов) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      .collapse-enter,
      .collapse-leave-to {
        max-height: 0;
        opacity: 0;
        transition: max-height 0.25s ease, opacity 0.25s ease;
      }
      .collapse-enter-to,
      .collapse-leave {
        max-height: 999px;
        opacity: 1;
      }
    </style>
  </head>
  <body class="bg-slate-50 text-gray-900">
    <header class="py-4 bg-indigo-600 text-white text-center text-2xl font-semibold">
      Многокруговой калькулятор распределения мандатов
    </header>

    <main class="max-w-6xl mx-auto p-4 space-y-8">
      <!-- Global controls -->
      <section class="bg-white p-4 rounded shadow">
        <div class="flex justify-between items-center">
          <h2 class="text-xl font-semibold">Настройки</h2>
          <button id="add-district" class="px-3 py-1 bg-indigo-600 text-white rounded hover:bg-indigo-700">
            + Добавить округ
          </button>
        </div>
        <p class="text-sm text-gray-600 mt-2">Калькулятор всегда строит <strong>все пять методов</strong> (Hare, Droop, Imperiali, D’Hondt, Sainte‑Laguë) ― выбор метода не требуется.</p>
      </section>

      <!-- Districts will be injected here -->
      <section id="districts-container" class="space-y-6"></section>

      <!-- Results -->
      <section id="results" class="space-y-8"></section>
    </main>

    <!-- Template for a district block -->
    <template id="district-template">
      <article class="bg-white p-4 rounded shadow" data-district>
        <header class="flex justify-between items-center mb-3">
          <input type="text" class="district-name border p-1 rounded w-full mr-2" placeholder="Название округа" />
          <div class="space-x-2">
            <button class="clone-district px-2 py-1 text-sm bg-slate-200 rounded hover:bg-slate-300">Clone</button>
            <button class="remove-district px-2 py-1 text-sm bg-red-500 text-white rounded hover:bg-red-600">×</button>
          </div>
        </header>

        <div class="grid grid-cols-5 gap-2 items-end mb-4">
          <label class="col-span-2 text-sm">Мандатов
            <input type="number" class="district-seats border p-1 rounded w-full" min="1" max="3000" value="10" />
          </label>
          <label class="col-span-2 text-sm">Барьер, %
            <input type="number" class="district-threshold border p-1 rounded w-full" min="0" max="20" step="0.1" value="0" />
          </label>
          <label class="col-span-1 text-sm">Tie‑break
            <select class="district-tiebreak border p-1 rounded w-full">
              <option value="votes">Most votes</option>
              <option value="least">Least votes</option>
              <option value="index">Lowest index</option>
              <option value="random">Random</option>
              <option value="disputed">Disputed</option>
            </select>
          </label>
        </div>

        <!-- Parties table -->
        <table class="w-full text-sm mb-3 border-collapse">
          <thead>
            <tr class="bg-slate-100">
              <th class="p-1 border">Партия</th>
              <th class="p-1 border">Голоса</th>
              <th class="p-1 border">Цвет</th>
              <th class="p-1 border w-8"></th>
            </tr>
          </thead>
          <tbody class="parties-body"></tbody>
        </table>
        <button class="add-party px-3 py-1 bg-slate-200 text-sm rounded hover:bg-slate-300">+ Добавить партию</button>
      </article>
    </template>

    <!-- Template for party row -->
    <template id="party-row-template">
      <tr data-party>
        <td class="border p-1"><input type="text" class="party-name w-full p-1 border rounded" placeholder="Название" /></td>
        <td class="border p-1"><input type="number" class="party-votes w-full p-1 border rounded" min="0" value="0" /></td>
        <td class="border p-1"><input type="color" class="party-color w-full h-6" value="#888888" /></td>
        <td class="border p-1 text-center"><button class="remove-party text-red-600">×</button></td>
      </tr>
    </template>

    <!-- Main bootstrap -->
    <script type="module" src="./main.js"></script>
  </body>
</html>
